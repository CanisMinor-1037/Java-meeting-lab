# Redis缓存击穿解决方案 - API文档

## 接口概述

本文档描述了Redis缓存击穿解决方案示例项目的所有API接口。项目提供了四种不同的缓存策略实现，用于演示不同的缓存击穿解决方案。

## 基础信息

- 基础URL: `http://localhost:8080`
- 响应格式: JSON
- 编码方式: UTF-8

## 接口列表

### 1. 无缓存方案

直接查询数据库，不进行缓存。

**请求信息：**
- 请求路径：`/api/products/{id}`
- 请求方法：GET
- 路径参数：
  - id: 商品ID（Long类型）

**响应示例：**
```json
{
    "id": 1,
    "name": "iPhone 15",
    "price": 999.99,
    "stock": 100
}
```

### 2. 基础缓存方案

使用Redis实现基础的缓存功能，但无法有效防止缓存击穿。

**请求信息：**
- 请求路径：`/api/products/cache/{id}`
- 请求方法：GET
- 路径参数：
  - id: 商品ID（Long类型）

**响应示例：**
```json
{
    "id": 1,
    "name": "iPhone 15",
    "price": 999.99,
    "stock": 100
}
```

### 3. Redis分布式锁方案

使用Redis的分布式锁来防止缓存击穿。

**请求信息：**
- 请求路径：`/api/products/lock/{id}`
- 请求方法：GET
- 路径参数：
  - id: 商品ID（Long类型）

**响应示例：**
```json
{
    "id": 1,
    "name": "iPhone 15",
    "price": 999.99,
    "stock": 100
}
```

### 4. Redisson分布式锁方案

使用Redisson提供的分布式锁来防止缓存击穿。

**请求信息：**
- 请求路径：`/api/products/redisson-lock/{id}`
- 请求方法：GET
- 路径参数：
  - id: 商品ID（Long类型）

**响应示例：**
```json
{
    "id": 1,
    "name": "iPhone 15",
    "price": 999.99,
    "stock": 100
}
```

## 测试数据说明

### 测试用例1：存在的数据
- ID: 1
- 预期结果：返回商品信息
- 用途：测试正常数据查询

### 测试用例2：不存在的数据
- ID: 2
- 预期结果：返回null
- 用途：测试缓存击穿防护效果

## 错误响应

当发生错误时，接口会返回以下格式的响应：

```json
{
    "timestamp": "2024-03-31T12:00:00.000+00:00",
    "status": 500,
    "error": "Internal Server Error",
    "message": "错误信息描述",
    "path": "/api/products/xxx"
}
```

## 注意事项

1. 所有接口的响应时间会因不同的缓存策略而有所差异
2. Redis分布式锁方案和Redisson分布式锁方案可以有效防止缓存击穿
3. 正常数据的缓存过期时间设置为30分钟
4. 分布式锁的过期时间设置为10秒
5. 当获取锁失败时，会等待100毫秒后重试 